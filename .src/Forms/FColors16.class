' Gambas class file

'
' GauchoCAD
'
' Copyright (C) Mart√≠n Belmonte
'
' This program is free software; you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation; either version 2 of the License, or
' (at your option) any later version.
'
' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.
'
' You should have received a copy of the GNU General Public License
' along with this program; if not, write to the Free Software
' Foundation, Inc., 51 Franklin St, Fifth Floor,
' Boston, MA  02110-1301  USA
'
Private Coords As Integer[]
Public xForm As Form

Public Sub _new(cor As Integer[], ByRef frm As Form)

  xForm = frm
  Coords = cor

End

Public Sub Form_Open()

  Dim i As Integer
  'Dim btn As ToolButton
  Dim crs As New String[]
  'Dim img As Image
  Dim s As Integer
  Dim r As Integer
  Dim g As Integer
  Dim b As Integer
  Dim j As Integer
  Dim k As Integer
  'Dim xPanel As Panel
  Dim rw As Integer

  s = 20
  crs = cad.DWGColors()

  GridView1.Header = GridView.None

  GridView1.Columns.Count = 16
  GridView1.Rows.Count = 16

  GridView1.Rows.Height = 20
  GridView1.Columns.Width = 20

  For j = 0 To 15
    For i = 0 To 15

      k = (rw * 16) + i

      r = CInt(Split(crs[k], ",")[0])
      g = CInt(Split(crs[k], ",")[1])
      b = CInt(Split(crs[k], ",")[2])
      Select k
        Case 0
          GridView1[rw, i].Text = "B"
          GridView1[rw, i].Alignment = Align.Center
          GridView1[rw, i].Background = Color.White
        Case 255
          GridView1[rw, i].Text = "L"
          GridView1[rw, i].Alignment = Align.Center
          GridView1[rw, i].Background = Color.White
        Case Else
          GridView1[rw, i].Background = Color.RGB(r, g, b)
      End Select

    Next
    Inc rw
  Next

  Me.Width = 16 * s
  Me.Height = 16 * s

  Me.Move(Coords[0], Coords[1])

End

Public Sub GridView1_Select()

  Dim fl As FLayers1
  Dim fm As APPMain
  Dim k As Integer

  Select xForm.Name
    Case "FLayers1"
      fl = xForm
      fl.SelectingColor = True
      k = (GridView1.Row * 16) + GridView1.Column
      fl.CurrentColor = k
    Case "APPMain"
      fm = xForm
      fm.SelectingColor = True
      k = (GridView1.Row * 16) + GridView1.Column
      fm.CurrentColor = k
  End Select

  Me.Close(True)

End

Public Sub GridView1_LostFocus()

  Dim fl As FLayers1

  Select xForm.Name
    Case "FLayers1"
      fl = xForm
      fl.SelectingColor = True
      'fl.CurrentColor = GridView1.Row + GridView1.Column
  End Select

  Me.Close(True)

End
