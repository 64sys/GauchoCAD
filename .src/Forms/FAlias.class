' Gambas class file

Private cals As Collection
'Private cad As New String[]

Public Sub _new(ByRef ctn As Collection)

    cals = ctn

End

Public Sub Run()

    Dim col As String
    Dim stx As New String[]
    Dim i As Integer
    'Dim cls As Class
    'Dim f As String
    'Dim cmd As String

    stx = [("Command"), ("Alias")]

    TableView1.Columns.Count = stx.Count

    For Each col In stx
        If i = 0 Then
            TableView1.Columns[i].Expand = True
        Endif
        TableView1.Columns[i].Title = col
        TableView1.Columns[i].Width = 75
        Inc i
    Next

    TableView1.Rows.Count = 0
    TableView1.Rows.Count = cals.Count

    Me.ShowModal()

    'Return Me.Close

End

Public Sub TableView1_Data(Row As Integer, Column As Integer)

    Dim r As Integer
    Dim cmd As Variant

    For Each cmd In cals
        If r = row Then
            Select Column
                Case 0
                    TableView1[row, Column].Text = cals.Key
                Case 1
                    TableView1[row, Column].Text = cmd
            End Select
        Endif
        Inc r
    Next

    TableView1.Refresh

End

Public Sub LMenu_Click()

    Dim obj As Object
    Dim i As Integer

    obj = Last

    Select obj.Tag

        Case "save"
            For i = 0 To TableView1.Rows.Count - 1
                cals.Add(TableView1[i, 1].Text, TableView1[i, 0].Text)
            Next

            Me.Close

        Case "cancel"

            Me.Close

    End Select

End

Public Sub TableView1_Change()

    Select TableView1.Column
        Case 0
            TableView1.Edit()
        Case 1
            TableView1.Edit
    End Select

End

Public Sub TableView1_Save(Row As Integer, Column As Integer, Value As String)

    TableView1[Row, Column].Text = String.UCase(Value)

End
