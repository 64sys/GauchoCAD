' Gambas class file

' GauchoCAD
' A simple CAD made in Gambas
'
' Copyright (C) Ing Martin P Cristia
'
' This program is free software; you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation; either version 3 of the License, or
' (at your option) any later version.
'
' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.
'
' You should have received a copy of the GNU General Public License
' along with this program; if not, write to the Free Software
' Foundation, Inc., 51 Franklin St, Fifth Floor,
' Boston, MA  02110-1301  USA

' Imports DXF 2007 files (limites entities and data)
' Tool maintained by Terco

Create Static
Public Const Gender As String = "Dxf"

Public Struct commonSt
  layer As String         ' 8
  handle As String        ' 5
  linetype As String      ' 6
  bColor As Integer       ' 62
  linetypescale As Float  ' 42 o 41
  visible As Integer      ' 60
  LineWt As Float         ' 370
End Struct

Public Struct lineSt
  x1 As Float
  y1 As Float
  x2 As Float
  y2 As Float
End Struct

Public Struct textSt
  x As Float              ' 10
  y As Float              ' 20
  altura As Float         ' 40
  texto As String         '  1
  rotacion As Float       ' 50
End Struct

Public Struct mtextSt
  x As Float              ' 10
  y As Float              ' 20
  h As Float              ' 10
  w As Float              ' 20
  alineacion As Integer

  altura As Float         ' 40
  texto As String         '  1
  rotacion As Float       ' 50
End Struct

Public Struct dimSt
  bloque As String        '  2
  p As Float[]            ' 10,20,11,21,12,22.......
  tipo As Integer          ' 70 0 = rotado 1 = alineado, 2 = angular
  alineacion As Integer   ' 71
  medida As Float         ' 42
  texto As String         ' 1 text override
  angulo As Float         ' 50
End Struct

Public Struct InsertSt
  block_name As String    '  2
  x As Float              ' 10
  y As Float              ' 20
  z As Float              ' 30
  escX As Float           ' 41
  escY As Float           ' 42
  escZ As Float           ' 43
  rotacion As Float       ' 50
End Struct

Public Struct blockSt
  layer As String         '  8
  block_name As String    '  2
  x As Float              ' 10
  y As Float              ' 20
  z As Float              ' 30
End Struct

Public Struct circleSt
  x As Float
  y As Float
  r As Float
End Struct

Public Struct arcSt
  x As Float
  y As Float
  r As Float
  sa As Float
  ea As Float
End Struct

Public Struct ellipseSt
  xc As Float
  yc As Float
  xm As Float
  ym As Float
  relacion As Float
  StartAngle As Float
  EndAngle As Float
End Struct

Public Struct StructpolylineSt
  vertexcount As Integer
  poliflag As Integer
  p As Float[]
End Struct

Public Struct solidSt
  p As Float[]
End Struct

Public Struct StructsplineeSt
  mKnotsPoints As Integer
  mFitPointCount As Integer
  mControlPointCount As Integer
  pKnotValues As Float[]
  pFit As Float[]
  pControl As Float[]
  pTangents As Float[]

End Struct

Public Nx As Integer
Public Ny As Integer
Public Dx As Float
Public Dy As Float
Public Np As Integer
Public Dp As Float

Public mCommon As New CommonSt
Public mLine As New LineSt
Public mCircle As New CircleSt
Public mEllipse As New EllipseSt
Public mPolyLine As New StructpolylineSt
Public mText As New TextSt
Public mMText As New TextSt
Public mSpline As New StructsplineeSt
Public mArc As New ArcSt
Public mInsert As New InsertSt
Public mBlock As New BlockSt
Public mSolid As New SolidSt
Public mDim As New DimSt

Private mBlockCount As Integer
Private mInsertCount As Integer
Private mTextcount As Integer
Private mMTextcount As Integer
Private mLineCount As Integer
Private mPolyLineCount As Integer
Private mPolyLinePointsCount As Integer
Private mCircleCount As Integer
Private mEllipseCount As Integer
Private mArcCount As Integer
Private mSplineCount As Integer
Private mSolidCount As Integer
Private mDimCount As Integer
Private mLayerCount As Integer

Private flgReadingBlock As Boolean

Public t As Float = Timer

Public fp As File
Private hFile As File

Public lpCode As String
Public lpValue As String

Public arrToFill As Entity[]

Private eExports As Boolean



Public Function SaveDXF(sName As String) As Integer

  Return SaveFile(sName)

End


Private Sub ReadData()

  Line Input #fp, lpcode
  Line Input #fp, lpValue

  If Right(lpcode, 1) = gb.Cr Then lpcode = Left(lpcode, -1)
  If Right(lpvalue, 1) = gb.cr Then lpvalue = Left(lpvalue, -1)

  lpcode = Trim$(lpcode)
  lpvalue = Trim$(lpvalue)

End


Public Sub FinishDXFRead()

  Print "SPlines", mSplineCount
  Print "lines", mLineCount
  Print "Polylines", mPolyLineCount
  Print "Circles", mCircleCount
  Print "Arcs", mArcCount
  Print "Texto", mTextcount
  Print "MTexto", mMTextcount
  Print "Inserts", mInsertcount
  Print "Blocks", mBlockCount
  Print "Dims", mDimCount
  Print
  Print "Total elements", mPolyLinePointsCount + mDimCount + mLineCount + mCircleCount + mMTextcount + mTextcount + mArcCount + mSplineCount + mInsertCount, " processed in ", Str(Timer - t), " Secconds"

  fp.Close

End

Public Function dxfLoad(sFile As String, Optional IgnoreLayers As Boolean = False, IgnoreBlocks As Boolean = False, IgnoreData As Boolean = False)

  fp = Open sFile For Read

  If Not fp Then Error.Raise("Error !")

  While Not Eof(fp)
    Wait 0.0001
    ReadData
    If lpCode = "0" And lpValue = "SECTION" Then
      ' vemos que seccion es
      ReadData
      If lpCode = "2" And lpValue = "HEADER" And Not IgnoreData Then dxfLoad1Headers

      If lpCode = "2" And lpValue = "CLASSES" Then Debug "CLASSES ignoradas"

      If lpCode = "2" And lpValue = "TABLES" And Not IgnoreLayers Then dxfLoad3Tables

      If lpCode = "2" And lpValue = "BLOCKS" And Not IgnoreBlocks Then dxfLoad4Blocks

      If lpCode = "2" And lpValue = "ENTITIES" Then dxfLoad5Entities

      If lpCode = "2" And lpValue = "OBJECTS" Then dxfLoad6Objects

    Endif
  Wend


End

Private Sub dxfLoad6Objects()



End



Private Sub dxfLoad5Entities(arrAcumulador As Entity[])

  Dim sClave As String[]
  Dim sValue As String[]
  Dim sEntidad As String
  Dim clsHandler As Object
  Dim eNueva As Entity

  ReadData
  Do
    sClave = New String[]

    sValue = New String[]

    sEntidad = lpValue

    If lpValue = "ENDSEC" Then Return

    ' Leo descentralizadamente las entidades

    While (lpcode <> "0") And Not Eof(fp)

      sClave.Add(lpCode)           ' el codigo es el tipo de variable
      sValue.Add(lpValue)

      ReadData

    Wend

    ' Termino la lectura de la entidad, busco a ver si la tengo lista
    clsHandler = Object.New("cad" & sEntidad)  ' obtenemos el tipo de entidad y buscamos su clase. Si no

    If clsHandler.DXF_reading Then                  ' verifico si la clase ya lee DXF

      eNueva = New Entity                           ' creo la entidad

      dxfReadCommonEntityData(eNueva, sClave, sValue)

      clsHandler.importDXF(eNueva, sClave, sValue)  ' la leo

      arrAcumulador.Add(eNueva)                     ' la acumulo en el array corresppondiente


    Endif



  Loop


End


Private Sub dxfLoad4Blocks()

  Dim mBlock As Block


  ReadData
  Do

    mBlock = New Block
    If lpCode = "0" And lpValue = "ENDSEC" Then Return

    If (lpcode = "0") And (lpvalue = "BLOCK") Then
      ReadData

      While (lpcode <> "0") And Not Eof(fp)
        'If lpcode = "5" Then mBlock.handle = lpvalue               ' Handle
        If lpcode = "8" Then mBlock.layer = lpvalue                ' Layer
        'If lpcode = "6" Then mBlock.linetype = lpvalue             ' LineType
        'If lpcode = "62" Then mBlock.bColor = CInt(lpvalue)        ' Color code (no es RBG) (256=ByLayer)
        'If lpcode = "370" Then mBlock.LineWt = CInt(lpvalue)        ' Color code (no es RBG) (256=ByLayer)
        If lpcode = "2" Then mBlock.name = lpValue
        If lpcode = "10" Then mBlock.x = CFloat(lpValue)         ' X
        If lpcode = "20" Then mBlock.y = CFloat(lpValue)         ' Y
        ReadData

      Wend
      ' si estoy leyendo bloques, significa que estoy abriendo un plano
      mBlock.entities = New Entity[]
      gcd.CurrentDrawing.arrBlocks.Add(mBlock)

      dxfLoad5Entities(gcd.CurrentDrawing.arrBlocks.Last.entities)


    Else If (lpcode = "0") And (lpvalue = "ENDBLK") Then

      ReadData

    Endif
  Loop

End


Private Sub dxfLoad3Tables()

  '    0
  ' TABLE
  ' 2
  ' VPORT
  '   5
  '   8
  ' 330
  '   0
  ' 100
  ' AcDbSymbolTable
  ' 70
  ' 1
  '   0
  ' VPORT

  ' Yo usare dos colecciones


  ReadData
  Do


    If lpCode = "0" And lpValue = "ENDSEC" Then Return
    Select Case lpValue ' VIEWPORT , LAYER, etc
      Case "LAYER"


        If lpvalue = "LAYER" Then
          Dim newLayer As JSONCollection, jscLayers As JSONCollection
          Inc mLayerCount

          ' "object": "LAYER",
          ' "index": 5,
          ' "type": 51,
          ' "handle": [0, 6],
          ' "size": 25,
          ' "bitsize": 120,
          ' "ownerhandle": [10, 1, 12, 18],
          ' "xdicobjhandle": [3, 2, 1762, 1762],
          ' "name": "0",
          ' "is_xref_ref": 1,
          ' "is_xref_resolved": 0,
          ' "is_xref_dep": 0,
          ' "xref": [5, 0, 0, 0],
          ' "flag": 1008,
          ' "linewt": 31,
          ' "color": 7,
          ' "plotstyle": [5, 1, 7, 7],
          ' "ltype": [5, 1, 10, 10]


          ' primero me fijo si existe
          If Not gcd.CurrentDrawing.cModel.Exist("LAYERS") Then
            jscLayers = New JSONCollection
            gcd.CurrentDrawing.cModel.Add(jscLayers, "LAYERS")
          Endif
          newlayer = New JSONCollection

          newlayer.Add(Format(mLayerCount, "0"), "id")
          ReadData
          While (lpcode <> "0") And Not Eof(fp)
            Debug lpcode, lpvalue
            If lpcode = "5" Then newlayer.Add(lpvalue, "handle")
            If lpcode = "2" Then
              If lpvalue = "" Then lpvalue = newlayer["id"]
              newlayer.Add(lpvalue, "name")

            End If
            If lpcode = "6" Then newLayer.Add(lpvalue, "style")
            If lpcode = "62" Then
              newLayer.Add(Abs(CInt(lpvalue)), "color")
              If CInt(lpvalue) > 0 Then newLayer.Add(True, "show") Else newLayer.Add(False, "show")
            End If
            ' If lpcode = "70" Then
            '   If ((CInt(lpvalue) And 2) = 2 Or (CInt(lpvalue) And 1) = 1) Then newLayer.Add(True, "locked") Else newLayer.Add(False, "locked")
            ' End If
            ' If lpcode = "20" Then
            '   If ((CInt(lpvalue) And 4) = 4) Then newLayer.Add(True, "frozen") Else newLayer.Add(False, "frozen")
            ' End If
            '
            ' If lpcode = "290" Then newLayer.Add(lpvalue, "print")
            ' If lpcode = "370" Then newLayer.Add(lpvalue, "width")
            ReadData
          Wend

          gcd.CurrentDrawing.cModel["LAYERS"].Add(newlayer, newLayer["name"])

        End If


    End Select

    ReadData
  Loop

End

Private Sub dxfLoad1Headers()

  ' Los header se guardan asi
  '   9                     Indica que es una variable
  ' $EXTMAX                 Nombre de la variable
  '  10                     Tipo de dato1
  ' 198.0411690635561       Dato1
  '  20                     Tipo de dato2
  ' 178.7767572407179       Dato2
  '  30                     etc
  '   0

  ' Yo usare dos colecciones

  Dim sVarName As String
  Dim sClave As String[]
  Dim sValue As String[]

  ReadData
  Do
    sClave = New String[]
    sValue = New String[]

    If lpCode = "0" And lpValue = "ENDSEC" Then Return

    If lpcode = "9" Then
      sVarName = lpValue
      Do                          ' este bucle es por si la variable es un array
        ReadData
        If lpcode = "0" Or lpCode = "9" Then Break
        sClave.Add(lpCode)           ' el codigo es el tipo de variable
        sValue.Add(lpValue)
      Loop

    Endif

    If sValue.Count > 1 Then

      gcd.CurrentDrawing.cHeader.Add(sValue, sVarName)
      gcd.CurrentDrawing.cHeaderCodes.Add(sClave, sVarName)
    Else
      gcd.CurrentDrawing.cHeader.Add(sValue, sVarName[0])
      gcd.CurrentDrawing.cHeaderCodes.Add(sClave, sVarName[0])

    End If
  Loop

End


Private Function dxfReadEntity(e As Entity, hFile As File)



End




Public Procedure LoadFile(stn As String, Optional IgnoreLayers As Boolean = False, IgnoreBlocks As Boolean = False, IgnoreData As Boolean = False)

  Dim i As Integer
  Dim mLoadStatus As Boolean
  Dim enxArray As Entity[]

  mBlockCount = 0
  mInsertCount = 0
  mTextcount = 0
  mMTextcount = 0
  mLineCount = 0
  mPolyLineCount = 0
  mPolyLinePointsCount = 0
  mCircleCount = 0
  mEllipseCount = 0
  mArcCount = 0
  mSplineCount = 0
  mSolidCount = 0
  mDimCount = 0
  mLayerCount = 0

  mPolyLine.p = New Float[]

  fp = Open stn For Read

  If Not fp Then Error.Raise("Error !")

  While Not Eof(fp)
    Wait 0.0001

    'Print lpcode, lpvalue
    If (lpvalue = "LINE") And Not Eof(fp) Then

      ReadData
      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "10" Then mLine.x1 = CFloat(lpvalue)
        If lpcode = "20" Then mLine.y1 = CFloat(lpvalue)
        If lpcode = "11" Then mLine.x2 = CFloat(lpvalue)
        If lpcode = "21" Then mLine.y2 = CFloat(lpvalue)
        ReadData
        Inc mLineCount

      Wend

      '
      AddLine(arrToFill, [mLine.x1, mLine.y1, mLine.x2, mLine.y2], mBlock.block_name)

      '-----------------------------------------------------------
      ' DIM
      '-----------------------------------------------------------
    Else If (lpcode = "0") And (lpvalue = "DIMENSION") Then

      ReadData
      mDim.p = New Float[]

      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "2" Then mDim.bloque = lpvalue
        If lpcode = "10" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "20" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "11" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "21" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "70" Then mDim.tipo = CInt(lpvalue)
        If lpcode = "71" Then mDim.alineacion = CInt(lpvalue)
        If lpcode = "42" Then mDim.medida = CFloat(lpvalue)
        If lpcode = "42" Then mDim.texto = lpvalue
        If lpcode = "12" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "13" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "14" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "15" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "16" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "26" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "22" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "23" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "24" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "25" Then mDim.p.Add(CFloat(lpvalue))
        If lpcode = "50" Then mDim.angulo = CFloat(lpvalue)

        ReadData
      Wend

      Inc mDimCount
      AddDim(arrToFill, mDim.p, mDim.bloque, mDim.medida, mDim.texto, mDim.alineacion, mDim.angulo, mDim.tipo, mBlock.block_name)

      '-----------------------------------------------------------
      ' LWPOLYLINE
      '-----------------------------------------------------------

      '' Lwpolyline command:
    Else If (lpcode = "0") And (lpvalue = "LWPOLYLINE") Then

      mPolyLine.p = New Float[]

      ReadData
      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "90" Then mPolyLine.vertexcount = Val(lpValue)
        If lpcode = "70" Then mPolyLine.poliflag = Val(lpValue)       ' 0 = abierta, 1 = cerrada
        If lpcode = "10" Then mPolyLine.p.Add(CFloat(lpValue))
        If lpcode = "20" Then mPolyLine.p.Add(CFloat(lpValue))

        ReadData
      Wend

      If mPolyLine.poliflag = 1 And mPolyLine.p.Count > 0 Then ' agrego el primer punto de nuevo
        mPolyLine.p.Add(mPolyLine.p[0])
        mPolyLine.p.Add(mPolyLine.p[1])
      End If
      mPolyLinePointsCount += mPolyLine.p.Count / 2
      Inc mPolyLineCount
      AddPolyLine(arrToFill, mPolyLine.p, mPolyLine.poliflag, mBlock.block_name)

      '-----------------------------------------------------------
      ' LAYER
      '-----------------------------------------------------------
    Else If (lpcode = "0") And (lpvalue = "LAYER") And Not IgnoreLayers Then
      Dim newLayer As JSONCollection, jscLayers As JSONCollection
      Inc mLayerCount

      ' "object": "LAYER",
      ' "index": 5,
      ' "type": 51,
      ' "handle": [0, 6],
      ' "size": 25,
      ' "bitsize": 120,
      ' "ownerhandle": [10, 1, 12, 18],
      ' "xdicobjhandle": [3, 2, 1762, 1762],
      ' "name": "0",
      ' "is_xref_ref": 1,
      ' "is_xref_resolved": 0,
      ' "is_xref_dep": 0,
      ' "xref": [5, 0, 0, 0],
      ' "flag": 1008,
      ' "linewt": 31,
      ' "color": 7,
      ' "plotstyle": [5, 1, 7, 7],
      ' "ltype": [5, 1, 10, 10]


      ' primero me fijo si existe
      If Not gcd.CurrentDrawing.cModel.Exist("LAYERS") Then
        jscLayers = New JSONCollection
        gcd.CurrentDrawing.cModel.Add(jscLayers, "LAYERS")
      Endif
      newlayer = New JSONCollection

      newlayer.Add(Format(mLayerCount, "0"), "id")
      ReadData
      While (lpcode <> "0") And Not Eof(fp)
        If lpcode = "5" Then newlayer.Add(lpvalue, "handle")
        If lpcode = "2" Then newlayer.Add(lpvalue, "name")

        If lpcode = "6" Then newLayer.Add(lpvalue, "style")
        If lpcode = "62" Then
          newLayer.Add(Abs(CInt(lpvalue)), "color")
          If CInt(lpvalue) > 0 Then newLayer.Add(True, "show") Else newLayer.Add(False, "show")
        End If
        ' If lpcode = "70" Then
        '   If ((CInt(lpvalue) And 2) = 2 Or (CInt(lpvalue) And 1) = 1) Then newLayer.Add(True, "locked") Else newLayer.Add(False, "locked")
        ' End If
        ' If lpcode = "20" Then
        '   If ((CInt(lpvalue) And 4) = 4) Then newLayer.Add(True, "frozen") Else newLayer.Add(False, "frozen")
        ' End If
        '
        ' If lpcode = "290" Then newLayer.Add(lpvalue, "print")
        ' If lpcode = "370" Then newLayer.Add(lpvalue, "width")
        ReadData
      Wend

      gcd.CurrentDrawing.cModel["LAYERS"].Add(newlayer, newLayer["name"])

      '-----------------------------------------------------------
      ' DIMSTYLE
      '-----------------------------------------------------------

    Else If (lpcode = "0") And (lpvalue = "DIMSTYLE") And Not IgnoreData Then
      Dim newCol As New Collection

      ReadData
      While (lpcode <> "0") And Not Eof(fp)
        If lpcode = "2" Then gcd.CurrentDrawing.cModel["DimSts"].Add(newCol, lpvalue)

        If lpcode = "40" Then newCol.Add(CFloat(lpvalue), "DIMSCALE")
        'If lpcode = "3" Then newCol.Add(CFloat(lpvalue), "DIMPOST")
        'If lpcode = "4" Then newCol.Add(CFloat(lpvalue), "DIMAPOST")

        ReadData
      Wend

      '-----------------------------------------------------------
      ' SOLID
      '-----------------------------------------------------------
    Else If (lpcode = "0") And (lpvalue = "SOLID") Then

      mSolid.p = New Float[]

      ReadData
      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "10" Then mSolid.p.Add(CFloat(lpValue))
        If lpcode = "20" Then mSolid.p.Add(CFloat(lpValue))
        If lpcode = "11" Then mSolid.p.Add(CFloat(lpValue))
        If lpcode = "21" Then mSolid.p.Add(CFloat(lpValue))
        If lpcode = "12" Then mSolid.p.Add(CFloat(lpValue))
        If lpcode = "22" Then mSolid.p.Add(CFloat(lpValue))
        If lpcode = "13" Then mSolid.p.Add(CFloat(lpValue))
        If lpcode = "23" Then mSolid.p.Add(CFloat(lpValue))
        ReadData
      Wend
      Inc mSolidCount
      AddSolid(arrToFill, mSolid.p, mBlock.block_name)

      '-----------------------------------------------------------
      ' CIRCLE
      '-----------------------------------------------------------
      '' Circle command:
    Else If (lpcode = "0") And (lpvalue = "CIRCLE") Then
      ReadData
      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "10" Then mCircle.x = CFloat(lpValue)
        If lpcode = "20" Then mCircle.y = CFloat(lpValue)
        If lpcode = "40" Then mCircle.r = CFloat(lpValue)
        ReadData
      Wend
      Inc mCircleCount
      ' Print "Circle", mCircle.layer, mCircle.x, mCircle.y, mCircle.r
      AddCircle(arrToFill, [mCircle.x, mCircle.y], mCircle.r, mBlock.block_name)

      '-----------------------------------------------------------
      ' ELLIPSE
      '-----------------------------------------------------------

    Else If (lpcode = "0") And (lpvalue = "ELLIPSE") Then

      ReadData

      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "10" Then mEllipse.xc = CFloat(lpValue)     ' centro
        If lpcode = "20" Then mEllipse.yc = CFloat(lpValue)
        If lpcode = "11" Then mEllipse.xm = CFloat(lpValue)     ' eje mayor, relativo al centro
        If lpcode = "21" Then mEllipse.ym = CFloat(lpValue)
        If lpcode = "40" Then mEllipse.relacion = CFloat(lpValue)
        If lpcode = "41" Then mEllipse.StartAngle = CFloat(lpValue)
        If lpcode = "42" Then mEllipse.EndAngle = CFloat(lpValue)
        ReadData
      Wend
      Inc mEllipseCount
      '
      AddEllipse(arrToFill, [mEllipse.xc, mEllipse.yc, mEllipse.xm, mEllipse.ym], mEllipse.relacion, mEllipse.StartAngle, mEllipse.EndAngle, mBlock.block_name)

      '-----------------------------------------------------------
      ' ARC
      '-----------------------------------------------------------
      ' Arc command
    Else If (lpcode = "0") And (lpvalue = "ARC") Then

      ReadData

      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "10" Then mArc.x = CFloat(lpValue)
        If lpcode = "20" Then mArc.y = CFloat(lpValue)
        If lpcode = "40" Then mArc.r = CFloat(lpValue)
        If lpcode = "50" Then mArc.sa = CFloat(lpValue)
        If lpcode = "51" Then mArc.ea = CFloat(lpValue)
        ReadData
      Wend
      Inc mArcCount
      ' Print "Arc", mCommon.layer, mArc.x, mArc.y, mArc.r, mArc.sa, mArc.ea
      Addarc(arrToFill, [mArc.x, mArc.y], mArc.r, mArc.sa, mArc.ea, mBlock.block_name)

      '
      '-----------------------------------------------------------
      ' SPLINE
      '-----------------------------------------------------------
    Else If (lpcode = "0") And (lpvalue = "SPLINE") Then
      mSpline.pFit = New Float[]
      mSpline.pControl = New Float[]
      mSpline.pKnotValues = New Float[]
      mSpline.pTangents = New Float[]

      ReadData
      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "72" Then mSpline.mKnotsPoints = Val(lpValue)
        If lpcode = "73" Then mSpline.mControlPointCount = Val(lpValue)
        If lpcode = "74" Then mSpline.mFitPointCount = Val(lpValue)

        If lpcode = "40" Then mSpline.pKnotValues.Add(CFloat(lpValue))

        If lpcode = "10" Then mSpline.pControl.Add(CFloat(lpValue))
        If lpcode = "20" Then mSpline.pControl.Add(CFloat(lpValue))
        If lpcode = "11" Then mSpline.pFit.Add(CFloat(lpValue))
        If lpcode = "21" Then mSpline.pFit.Add(CFloat(lpValue))
        If lpcode = "12" Then mSpline.pTangents.Add(CFloat(lpValue))
        If lpcode = "22" Then mSpline.pTangents.Add(CFloat(lpValue))
        If lpcode = "13" Then mSpline.pTangents.Add(CFloat(lpValue))
        If lpcode = "23" Then mSpline.pTangents.Add(CFloat(lpValue))

        ReadData
      Wend

      Inc mSplineCount

      AddSPLine(arrToFill, mSpline.pControl, 0, mBlock.block_name)

      '-----------------------------------------------------------
      ' TEXT
      '-----------------------------------------------------------


    Else If (lpcode = "0") And (lpvalue = "TEXT") Then

      ReadData
      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "10" Then mText.x = CFloat(lpValue)         ' X1
        If lpcode = "20" Then mText.y = CFloat(lpValue)         ' Y1
        If lpcode = "40" Then mText.altura = CFloat(lpValue)         ' Altura
        If lpcode = "1" Then mText.texto = lpValue                 ' Texto
        If lpcode = "50" Then mText.rotacion = CFloat(lpValue)      ' rotacion
        ReadData
      Wend

      Inc mTextCount
      AddText(arrToFill, [mText.x, mText.y], mText.rotacion, mText.altura, mText.texto, mBlock.block_name)

      '-----------------------------------------------------------
      ' MTEXT
      '-----------------------------------------------------------

    Else If (lpcode = "0") And (lpvalue = "MTEXT") Then

      mMText.texto = ""
      ReadData

      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "10" Then mMText.x = CFloat(lpValue)                ' X1
        If lpcode = "20" Then mMText.y = CFloat(lpValue)                ' Y1
        If lpcode = "40" Then mMText.altura = CFloat(lpValue)              ' Altura
        If lpcode = "3" Or lpcode = "1" Then mMText.texto &= lpValue    ' Texto
        If lpcode = "50" Then mMText.rotacion = CFloat(lpValue)      ' rotacion
        ReadData
      Wend
      Inc mMTextCount
      AddMText(arrToFill, [mMText.x, mMText.y], mMText.rotacion, mMText.altura, mMText.texto, mBlock.block_name)

      '-----------------------------------------------------------
      ' INSERT
      '-----------------------------------------------------------
      '
    Else If (lpcode = "0") And (lpvalue = "INSERT") Then

      ReadData
      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "2" Then mInsert.block_name = lpValue
        If lpcode = "10" Then mInsert.x = CFloat(lpValue)         ' X
        If lpcode = "20" Then mInsert.y = CFloat(lpValue)         ' Y
        If lpcode = "41" Then mInsert.escX = CFloat(lpValue)         ' esc X
        If lpcode = "42" Then mInsert.escY = CFloat(lpValue)         ' esc Y
        If lpcode = "50" Then mInsert.rotacion = CFloat(lpValue)      ' rotacion
        ReadData

      Wend

      Inc mInsertCount
      AddInsert(arrToFill, [mInsert.x, mInsert.y], mInsert.escX, mInsert.escY, mInsert.rotacion, mInsert.block_name)

      '-----------------------------------------------------------
      ' BLOCK
      '-----------------------------------------------------------
      '
    Else If (lpcode = "0") And (lpvalue = "BLOCK") And Not IgnoreBlocks Then
      ReadData
      FlgReadingBlock = True
      While (lpcode <> "0") And Not Eof(fp)
        dxfReadCommonData
        If lpcode = "2" Then mBlock.block_name = lpValue
        If lpcode = "10" Then mBlock.x = CFloat(lpValue)         ' X
        If lpcode = "20" Then mBlock.y = CFloat(lpValue)         ' Y
        ReadData

      Wend
      mBlock.layer = mCommon.layer

      enxArray = arrToFill

      arrToFill = AddBlock([mBlock.x, mBlock.y], mBlock.block_name)

      Inc mBlockCount

    Else If (lpcode = "0") And (lpvalue = "ENDBLK") And Not IgnoreBlocks Then
      ReadData
      flgReadingBlock = False
      mBlock.block_name = ""
      arrToFill = enxArray

    Else
      ReadData

    Endif

  Wend

  FinishDXFRead

  Return

End

Private Sub dxfReadCommonEntityData(e As Entity, sCode As String[], sValue As String[])

  Dim i As Integer

  For i = 0 To sValue.Max

    If sCode[i] = "5" Then e.handle = sValue[i]             ' Handle
    If sCode[i] = "8" Then e.layer = sValue[i]              ' Layer
    If sCode[i] = "6" Then e.LineType = sValue[i]           ' LineType
    If sCode[i] = "62" Then e.colour = CInt(sValue[i])      ' Color code (no es RBG) (256=ByLayer)
    If sCode[i] = "370" Then e.LineWidth = CInt(sValue[i])  ' debemos ir a una tabla para ver
  Next

End


Private Sub dxfReadCommonData()

  If lpcode = "5" Then mCommon.handle = lpvalue               ' Handle
  If lpcode = "8" Then mCommon.layer = lpvalue                ' Layer
  If lpcode = "6" Then mCommon.linetype = lpvalue             ' LineType
  If lpcode = "62" Then mCommon.bColor = CInt(lpvalue)        ' Color code (no es RBG) (256=ByLayer)
  If lpcode = "370" Then mCommon.LineWt = CInt(lpvalue)        ' Color code (no es RBG) (256=ByLayer)

End

Private Function SaveFile(sName As String) As Integer

  hFile = Open sName For Write Create

  If dxfSave1HeadersAndVars() Then Return False
  If dxfSave2Tables() Then Return False
  If dxfSave3BlockRecord() Then Return False
  If dxfSave4Blocks() Then Return False
  If dxfSave5Entities() Then Return False
  If dxfSave6Objects() Then Return False

  hFile.Close

End

Private Function dxfSave1HeadersAndVars() As Integer

  Print #hFIle, "999"
  Print #hFIle, "GauchoCAD"
  Print #hFIle, "  0"
  Print #hFIle, "SECTION"
  Print #hFIle, "2"
  Print #hFIle, "HEADER"
  Print #hFIle, "9"
  Print #hFIle, "$ACADVER"
  Print #hFIle, "1"
  Print #hFIle, "AC1021"
  Print #hFIle, "9"
  Print #hFIle, "$DWGCODEPAGE"
  Print #hFIle, "3"
  Print #hFIle, "ANSI_1252"
  Print #hFIle, "9"
  Print #hFIle, "$INSBASE"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$EXTMIN"
  Print #hFIle, " 10"
  Print #hFIle, "40.57704609229131"
  Print #hFIle, " 20"
  Print #hFIle, "48.2123375502228"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$EXTMAX"
  Print #hFIle, " 10"
  Print #hFIle, "198.0411690635561"
  Print #hFIle, " 20"
  Print #hFIle, "178.7767572407179"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$LIMMIN"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$LIMMAX"
  Print #hFIle, " 10"
  Print #hFIle, "420"
  Print #hFIle, " 20"
  Print #hFIle, "297"
  Print #hFIle, "9"
  Print #hFIle, "$ORTHOMODE"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$REGENMODE"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$FILLMODE"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$QTEXTMODE"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$MIRRTEXT"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$LTSCALE"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$ATTMODE"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$TEXTSIZE"
  Print #hFIle, "40"
  Print #hFIle, "2.5"
  Print #hFIle, "9"
  Print #hFIle, "$TRACEWID"
  Print #hFIle, "40"
  Print #hFIle, "15.68"
  Print #hFIle, "9"
  Print #hFIle, "$TEXTSTYLE"
  Print #hFIle, "7"
  Print #hFIle, "STANDARD"
  Print #hFIle, "9"
  Print #hFIle, "$CLAYER"
  Print #hFIle, "  8"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$CELTYPE"
  Print #hFIle, "6"
  Print #hFIle, "BYLAYER"
  Print #hFIle, "9"
  Print #hFIle, "$CECOLOR"
  Print #hFIle, "62"
  Print #hFIle, "256"
  Print #hFIle, "9"
  Print #hFIle, "$CELTSCALE"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DISPSILH"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMSCALE"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DIMASZ"
  Print #hFIle, "40"
  Print #hFIle, "2.5"
  Print #hFIle, "9"
  Print #hFIle, "$DIMEXO"
  Print #hFIle, "40"
  Print #hFIle, "625"
  Print #hFIle, "9"
  Print #hFIle, "$DIMDLI"
  Print #hFIle, "40"
  Print #hFIle, "3.75"
  Print #hFIle, "9"
  Print #hFIle, "$DIMRND"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMDLE"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMEXE"
  Print #hFIle, "40"
  Print #hFIle, "1.25"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTP"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTM"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTXT"
  Print #hFIle, "40"
  Print #hFIle, "2.5"
  Print #hFIle, "9"
  Print #hFIle, "$DIMCEN"
  Print #hFIle, "40"
  Print #hFIle, "2.5"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTSZ"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTOL"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMLIM"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTIH"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTOH"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMSE1"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMSE2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTAD"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DIMZIN"
  Print #hFIle, "70"
  Print #hFIle, "  8"
  Print #hFIle, "9"
  Print #hFIle, "$DIMBLK"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$DIMASO"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DIMSHO"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DIMPOST"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$DIMAPOST"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$DIMALT"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMALTD"
  Print #hFIle, "70"
  Print #hFIle, "3"
  Print #hFIle, "9"
  Print #hFIle, "$DIMALTF"
  Print #hFIle, "40"
  Print #hFIle, "0.03937"
  Print #hFIle, "9"
  Print #hFIle, "$DIMLFAC"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTOFL"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTVP"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTIX"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMSOXD"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMSAH"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMBLK1"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$DIMBLK2"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$DIMSTYLE"
  Print #hFIle, "2"
  Print #hFIle, "STANDARD"
  Print #hFIle, "9"
  Print #hFIle, "$DIMCLRD"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMCLRE"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMCLRT"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTFAC"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DIMGAP"
  Print #hFIle, "40"
  Print #hFIle, "625"
  Print #hFIle, "9"
  Print #hFIle, "$DIMJUST"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMSD1"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMSD2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTOLJ"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTZIN"
  Print #hFIle, "70"
  Print #hFIle, "  8"
  Print #hFIle, "9"
  Print #hFIle, "$DIMALTZ"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMALTTZ"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMUPT"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMDEC"
  Print #hFIle, "70"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTDEC"
  Print #hFIle, "70"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$DIMALTU"
  Print #hFIle, "70"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$DIMALTTD"
  Print #hFIle, "70"
  Print #hFIle, "3"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTXSTY"
  Print #hFIle, "7"
  Print #hFIle, "STANDARD"
  Print #hFIle, "9"
  Print #hFIle, "$DIMAUNIT"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMADEC"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMALTRND"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMAZIN"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMDSEP"
  Print #hFIle, "70"
  Print #hFIle, "44"
  Print #hFIle, "9"
  Print #hFIle, "$DIMATFIT"
  Print #hFIle, "70"
  Print #hFIle, "3"
  Print #hFIle, "9"
  Print #hFIle, "$DIMFRAC"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMLDRBLK"
  Print #hFIle, "1"
  Print #hFIle, "STANDARD"
  Print #hFIle, "9"
  Print #hFIle, "$DIMLUNIT"
  Print #hFIle, "70"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$DIMLWD"
  Print #hFIle, "70"
  Print #hFIle, "-2"
  Print #hFIle, "9"
  Print #hFIle, "$DIMLWE"
  Print #hFIle, "70"
  Print #hFIle, "-2"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTMOVE"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMFXL"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DIMFXLON"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMJOGANG"
  Print #hFIle, "40"
  Print #hFIle, "0.7854"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTFILL"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMTFILLCLR"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMARCSYM"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$DIMLTYPE"
  Print #hFIle, "6"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$DIMLTEX1"
  Print #hFIle, "6"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$DIMLTEX2"
  Print #hFIle, "6"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$LUNITS"
  Print #hFIle, "70"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$LUPREC"
  Print #hFIle, "70"
  Print #hFIle, "4"
  Print #hFIle, "9"
  Print #hFIle, "$SKETCHINC"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$FILLETRAD"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$AUNITS"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$AUPREC"
  Print #hFIle, "70"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$MENU"
  Print #hFIle, "1"
  Print #hFIle, "."
  Print #hFIle, "9"
  Print #hFIle, "$ELEVATION"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PELEVATION"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$THICKNESS"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$LIMCHECK"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$CHAMFERA"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$CHAMFERB"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$CHAMFERC"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$CHAMFERD"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$SKPOLY"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USRTIMER"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$ANGBASE"
  Print #hFIle, "50"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$ANGDIR"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PDMODE"
  Print #hFIle, "70"
  Print #hFIle, "34"
  Print #hFIle, "9"
  Print #hFIle, "$PDSIZE"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PLINEWID"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$SPLFRAME"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$SPLINETYPE"
  Print #hFIle, "70"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$SPLINESEGS"
  Print #hFIle, "70"
  Print #hFIle, "  8"
  Print #hFIle, "9"
  Print #hFIle, "$HANDSEED"
  Print #hFIle, "  5"
  Print #hFIle, "20000"
  Print #hFIle, "9"
  Print #hFIle, "$SURFTAB1"
  Print #hFIle, "70"
  Print #hFIle, "6"
  Print #hFIle, "9"
  Print #hFIle, "$SURFTAB2"
  Print #hFIle, "70"
  Print #hFIle, "6"
  Print #hFIle, "9"
  Print #hFIle, "$SURFTYPE"
  Print #hFIle, "70"
  Print #hFIle, "6"
  Print #hFIle, "9"
  Print #hFIle, "$SURFU"
  Print #hFIle, "70"
  Print #hFIle, "6"
  Print #hFIle, "9"
  Print #hFIle, "$SURFV"
  Print #hFIle, "70"
  Print #hFIle, "6"
  Print #hFIle, "9"
  Print #hFIle, "$UCSBASE"
  Print #hFIle, "2"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$UCSNAME"
  Print #hFIle, "2"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$UCSORG"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$UCSXDIR"
  Print #hFIle, " 10"
  Print #hFIle, "1"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$UCSYDIR"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "1"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$UCSORTHOREF"
  Print #hFIle, "2"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$UCSORTHOVIEW"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$UCSORGTOP"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$UCSORGBOTTOM"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$UCSORGLEFT"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$UCSORGRIGHT"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$UCSORGFRONT"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$UCSORGBACK"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSBASE"
  Print #hFIle, "2"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$PUCSNAME"
  Print #hFIle, "2"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$PUCSORG"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSXDIR"
  Print #hFIle, " 10"
  Print #hFIle, "1"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSYDIR"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "1"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSORTHOREF"
  Print #hFIle, "2"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$PUCSORTHOVIEW"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSORGTOP"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSORGBOTTOM"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSORGLEFT"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSORGRIGHT"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSORGFRONT"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PUCSORGBACK"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERI1"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERI2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERI3"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERI4"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERI5"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERR1"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERR2"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERR3"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERR4"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$USERR5"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$WORLDVIEW"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$SHADEDGE"
  Print #hFIle, "70"
  Print #hFIle, "3"
  Print #hFIle, "9"
  Print #hFIle, "$SHADEDIF"
  Print #hFIle, "70"
  Print #hFIle, "70"
  Print #hFIle, "9"
  Print #hFIle, "$TILEMODE"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$MAXACTVP"
  Print #hFIle, "70"
  Print #hFIle, "64"
  Print #hFIle, "9"
  Print #hFIle, "$PINSBASE"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PLIMCHECK"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PEXTMIN"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PEXTMAX"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$GRIDMODE"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$SNAPSTYLE"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PLIMMIN"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PLIMMAX"
  Print #hFIle, " 10"
  Print #hFIle, "210"
  Print #hFIle, " 20"
  Print #hFIle, "297"
  Print #hFIle, "9"
  Print #hFIle, "$UNITMODE"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$VISRETAIN"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$PLINEGEN"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PSLTSCALE"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$TREEDEPTH"
  Print #hFIle, "70"
  Print #hFIle, "3020"
  Print #hFIle, "9"
  Print #hFIle, "$CMLSTYLE"
  Print #hFIle, "2"
  Print #hFIle, "Standard"
  Print #hFIle, "9"
  Print #hFIle, "$CMLJUST"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$CMLSCALE"
  Print #hFIle, "40"
  Print #hFIle, " 20"
  Print #hFIle, "9"
  Print #hFIle, "$PROXYGRAPHICS"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$MEASUREMENT"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$CELWEIGHT"
  Print #hFIle, "370"
  Print #hFIle, "-1"
  Print #hFIle, "9"
  Print #hFIle, "$ENDCAPS"
  Print #hFIle, "280"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$JOINSTYLE"
  Print #hFIle, "280"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$LWDISPLAY"
  Print #hFIle, "290"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$INSUNITS"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$HYPERLINKBASE"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$STYLESHEET"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$XEDIT"
  Print #hFIle, "290"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$CEPSNTYPE"
  Print #hFIle, "380"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$PSTYLEMODE"
  Print #hFIle, "290"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$EXTNAMES"
  Print #hFIle, "290"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$PSVPSCALE"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$OLESTARTUP"
  Print #hFIle, "290"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$SORTENTS"
  Print #hFIle, "280"
  Print #hFIle, "127"
  Print #hFIle, "9"
  Print #hFIle, "$INDEXCTL"
  Print #hFIle, "280"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$HIDETEXT"
  Print #hFIle, "280"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$XCLIPFRAME"
  Print #hFIle, "290"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$HALOGAP"
  Print #hFIle, "280"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$OBSCOLOR"
  Print #hFIle, "70"
  Print #hFIle, "257"
  Print #hFIle, "9"
  Print #hFIle, "$OBSLTYPE"
  Print #hFIle, "280"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$INTERSECTIONDISPLAY"
  Print #hFIle, "280"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$INTERSECTIONCOLOR"
  Print #hFIle, "70"
  Print #hFIle, "257"
  Print #hFIle, "9"
  Print #hFIle, "$DIMASSOC"
  Print #hFIle, "280"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$PROJECTNAME"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "9"
  Print #hFIle, "$CAMERADISPLAY"
  Print #hFIle, "290"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$LENSLENGTH"
  Print #hFIle, "40"
  Print #hFIle, "50"
  Print #hFIle, "9"
  Print #hFIle, "$CAMERAHEIGHT"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$STEPSPERSEC"
  Print #hFIle, "40"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$STEPSIZE"
  Print #hFIle, "40"
  Print #hFIle, "50"
  Print #hFIle, "9"
  Print #hFIle, "$3DDWFPREC"
  Print #hFIle, "40"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$PSOLWIDTH"
  Print #hFIle, "40"
  Print #hFIle, "  5"
  Print #hFIle, "9"
  Print #hFIle, "$PSOLHEIGHT"
  Print #hFIle, "40"
  Print #hFIle, "80"
  Print #hFIle, "9"
  Print #hFIle, "$LOFTANG1"
  Print #hFIle, "40"
  Print #hFIle, "1.570796326794897"
  Print #hFIle, "9"
  Print #hFIle, "$LOFTANG2"
  Print #hFIle, "40"
  Print #hFIle, "1.570796326794897"
  Print #hFIle, "9"
  Print #hFIle, "$LOFTMAG1"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$LOFTMAG2"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$LOFTPARAM"
  Print #hFIle, "70"
  Print #hFIle, "7"
  Print #hFIle, "9"
  Print #hFIle, "$LOFTNORMALS"
  Print #hFIle, "280"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$LATITUDE"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$LONGITUDE"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$NORTHDIRECTION"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$TIMEZONE"
  Print #hFIle, "70"
  Print #hFIle, "-8000"
  Print #hFIle, "9"
  Print #hFIle, "$LIGHTGLYPHDISPLAY"
  Print #hFIle, "280"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$TILEMODELIGHTSYNCH"
  Print #hFIle, "280"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$SOLIDHIST"
  Print #hFIle, "280"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$SHOWHIST"
  Print #hFIle, "280"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$DWFFRAME"
  Print #hFIle, "280"
  Print #hFIle, "2"
  Print #hFIle, "9"
  Print #hFIle, "$DGNFRAME"
  Print #hFIle, "280"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$REALWORLDSCALE"
  Print #hFIle, "290"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$INTERFERECOLOR"
  Print #hFIle, "62"
  Print #hFIle, "1"
  Print #hFIle, "9"
  Print #hFIle, "$CSHADOW"
  Print #hFIle, "280"
  Print #hFIle, "  0"
  Print #hFIle, "9"
  Print #hFIle, "$SHADOWPLANELOCATION"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "ENDSEC"

End

Private Function dxfSave2Tables() As Integer

  Print #hFIle, "  0"
  Print #hFIle, "SECTION"
  Print #hFIle, "2"
  Print #hFIle, "CLASSES"
  Print #hFIle, "  0"
  Print #hFIle, "ENDSEC"
  Print #hFIle, "  0"
  Print #hFIle, "SECTION"
  Print #hFIle, "2"
  Print #hFIle, "TABLES"
  Print #hFIle, "  0"
  Print #hFIle, "TABLE"
  Print #hFIle, "2"
  Print #hFIle, "VPORT"
  Print #hFIle, "  5"
  Print #hFIle, "  8"
  Print #hFIle, "330"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTable"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "  0"
  Print #hFIle, "VPORT"
  Print #hFIle, "  5"
  Print #hFIle, "31"
  Print #hFIle, "330"
  Print #hFIle, "2"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbViewportTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "*ACTIVE"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, "11"
  Print #hFIle, "1"
  Print #hFIle, "21"
  Print #hFIle, "1"
  Print #hFIle, "12"
  Print #hFIle, "128.2117600542269"
  Print #hFIle, "22"
  Print #hFIle, "90.6887816290902"
  Print #hFIle, "13"
  Print #hFIle, "  0"
  Print #hFIle, "23"
  Print #hFIle, "  0"
  Print #hFIle, "14"
  Print #hFIle, " 10"
  Print #hFIle, "24"
  Print #hFIle, " 10"
  Print #hFIle, "15"
  Print #hFIle, " 10"
  Print #hFIle, "25"
  Print #hFIle, " 10"
  Print #hFIle, "16"
  Print #hFIle, "  0"
  Print #hFIle, "26"
  Print #hFIle, "  0"
  Print #hFIle, "36"
  Print #hFIle, "1"
  Print #hFIle, "17"
  Print #hFIle, "  0"
  Print #hFIle, "27"
  Print #hFIle, "  0"
  Print #hFIle, "37"
  Print #hFIle, "  0"
  Print #hFIle, "40"
  Print #hFIle, "162.5665714355525"
  Print #hFIle, "41"
  Print #hFIle, "1.401948842874543"
  Print #hFIle, "42"
  Print #hFIle, "50"
  Print #hFIle, "43"
  Print #hFIle, "  0"
  Print #hFIle, "44"
  Print #hFIle, "  0"
  Print #hFIle, "50"
  Print #hFIle, "  0"
  Print #hFIle, "51"
  Print #hFIle, "  0"
  Print #hFIle, "71"
  Print #hFIle, "  0"
  Print #hFIle, "72"
  Print #hFIle, "100"
  Print #hFIle, "73"
  Print #hFIle, "1"
  Print #hFIle, "74"
  Print #hFIle, "3"
  Print #hFIle, "75"
  Print #hFIle, "  0"
  Print #hFIle, "76"
  Print #hFIle, "1"
  Print #hFIle, "77"
  Print #hFIle, "  0"
  Print #hFIle, "78"
  Print #hFIle, "  0"
  Print #hFIle, "281"
  Print #hFIle, "  0"
  Print #hFIle, "65"
  Print #hFIle, "1"
  Print #hFIle, "110"
  Print #hFIle, "  0"
  Print #hFIle, "120"
  Print #hFIle, "  0"
  Print #hFIle, "130"
  Print #hFIle, "  0"
  Print #hFIle, "111"
  Print #hFIle, "1"
  Print #hFIle, "121"
  Print #hFIle, "  0"
  Print #hFIle, "131"
  Print #hFIle, "  0"
  Print #hFIle, "112"
  Print #hFIle, "  0"
  Print #hFIle, "122"
  Print #hFIle, "1"
  Print #hFIle, "132"
  Print #hFIle, "  0"
  Print #hFIle, "79"
  Print #hFIle, "  0"
  Print #hFIle, "146"
  Print #hFIle, "  0"
  Print #hFIle, "348"
  Print #hFIle, "10020"
  Print #hFIle, "60"
  Print #hFIle, "7"
  Print #hFIle, "61"
  Print #hFIle, "  5"
  Print #hFIle, "292"
  Print #hFIle, "1"
  Print #hFIle, "282"
  Print #hFIle, "1"
  Print #hFIle, "141"
  Print #hFIle, "  0"
  Print #hFIle, "142"
  Print #hFIle, "  0"
  Print #hFIle, "63"
  Print #hFIle, "250"
  Print #hFIle, "421"
  Print #hFIle, "3358443"
  Print #hFIle, "  0"
  Print #hFIle, "ENDTAB"
  Print #hFIle, "  0"
  Print #hFIle, "TABLE"
  Print #hFIle, "2"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "  5"
  Print #hFIle, "330"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTable"
  Print #hFIle, "70"
  Print #hFIle, "4"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "14"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "ByBlock"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, ""
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "  0"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "15"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "ByLayer"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, ""
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "  0"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "16"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "Continuous"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Solid line"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "  0"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "32"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DOT"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dot . . . . . . . . . . . . . . . . . . . . . ."
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "2"
  Print #hFIle, "40"
  Print #hFIle, "6.35"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "33"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DOTTINY"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dot (.15x) ....................................."
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "2"
  Print #hFIle, "40"
  Print #hFIle, "0.9525"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "34"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DOT2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dot (.5x) ....................................."
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "2"
  Print #hFIle, "40"
  Print #hFIle, "3175"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "35"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DOTX2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dot (2x) .  .  .  .  .  .  .  .  .  .  .  .  ."
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "2"
  Print #hFIle, "40"
  Print #hFIle, "12.7"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "36"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DASHED"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dashed _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "2"
  Print #hFIle, "40"
  Print #hFIle, "19.05"
  Print #hFIle, "49"
  Print #hFIle, "12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "37"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DASHEDTINY"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dashed (.15x) _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "2"
  Print #hFIle, "40"
  Print #hFIle, "2.8575"
  Print #hFIle, "49"
  Print #hFIle, "1905"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "38"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DASHED2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dashed (.5x) _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "2"
  Print #hFIle, "40"
  Print #hFIle, "9.524999999999999"
  Print #hFIle, "49"
  Print #hFIle, "6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "39"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DASHEDX2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dashed (2x) ____  ____  ____  ____  ____  ___"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "2"
  Print #hFIle, "40"
  Print #hFIle, "38.09999999999999"
  Print #hFIle, "49"
  Print #hFIle, "25.4"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "3A"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DASHDOT"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dash dot __ . __ . __ . __ . __ . __ . __ . __"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "4"
  Print #hFIle, "40"
  Print #hFIle, "25.4"
  Print #hFIle, "49"
  Print #hFIle, "12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "3B"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DASHDOTTINY"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dash dot (.15x) _._._._._._._._._._._._._._._."
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "4"
  Print #hFIle, "40"
  Print #hFIle, "3.81"
  Print #hFIle, "49"
  Print #hFIle, "1905"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "3C"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DASHDOT2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dash dot (.5x) _._._._._._._._._._._._._._._."
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "4"
  Print #hFIle, "40"
  Print #hFIle, "12.7"
  Print #hFIle, "49"
  Print #hFIle, "6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "3D"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DASHDOTX2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Dash dot (2x) ____  .  ____  .  ____  .  ___"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "4"
  Print #hFIle, "40"
  Print #hFIle, "50.8"
  Print #hFIle, "49"
  Print #hFIle, "25.4"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "3E"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DIVIDE"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Divide ____ . . ____ . . ____ . . ____ . . ____"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "6"
  Print #hFIle, "40"
  Print #hFIle, "31.75"
  Print #hFIle, "49"
  Print #hFIle, "12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "3F"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DIVIDETINY"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Divide (.15x) __..__..__..__..__..__..__..__.._"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "6"
  Print #hFIle, "40"
  Print #hFIle, "4.7625"
  Print #hFIle, "49"
  Print #hFIle, "1905"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "40"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DIVIDE2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Divide (.5x) __..__..__..__..__..__..__..__.._"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "6"
  Print #hFIle, "40"
  Print #hFIle, "15875"
  Print #hFIle, "49"
  Print #hFIle, "6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "41"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "DIVIDEX2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Divide (2x) ________  .  .  ________  .  .  _"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "6"
  Print #hFIle, "40"
  Print #hFIle, "63.5"
  Print #hFIle, "49"
  Print #hFIle, "25.4"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "42"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "BORDER"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Border __ __ . __ __ . __ __ . __ __ . __ __ ."
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "6"
  Print #hFIle, "40"
  Print #hFIle, "44.45"
  Print #hFIle, "49"
  Print #hFIle, "12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "43"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "BORDERTINY"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Border (.15x) __.__.__.__.__.__.__.__.__.__.__."
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "6"
  Print #hFIle, "40"
  Print #hFIle, "6.6675"
  Print #hFIle, "49"
  Print #hFIle, "1905"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "1905"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "44"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "BORDER2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Border (.5x) __.__.__.__.__.__.__.__.__.__.__."
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "6"
  Print #hFIle, "40"
  Print #hFIle, "22225"
  Print #hFIle, "49"
  Print #hFIle, "6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "45"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "BORDERX2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Border (2x) ____  ____  .  ____  ____  .  ___"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "6"
  Print #hFIle, "40"
  Print #hFIle, "88.89999999999999"
  Print #hFIle, "49"
  Print #hFIle, "25.4"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "25.4"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "46"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "CENTER"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Center ____ _ ____ _ ____ _ ____ _ ____ _ ____"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "4"
  Print #hFIle, "40"
  Print #hFIle, "50.8"
  Print #hFIle, "49"
  Print #hFIle, "31.75"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-6.35"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "47"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "CENTERTINY"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Center (.15x) ___ _ ___ _ ___ _ ___ _ ___ _ ___"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "4"
  Print #hFIle, "40"
  Print #hFIle, "7.619999999999999"
  Print #hFIle, "49"
  Print #hFIle, "4.7625"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-0.9525"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "48"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "CENTER2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Center (.5x) ___ _ ___ _ ___ _ ___ _ ___ _ ___"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "4"
  Print #hFIle, "40"
  Print #hFIle, "28575"
  Print #hFIle, "49"
  Print #hFIle, "19.05"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-3175"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "LTYPE"
  Print #hFIle, "  5"
  Print #hFIle, "49"
  Print #hFIle, "330"
  Print #hFIle, "  5"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbLinetypeTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "CENTERX2"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "Center (2x) ________  __  ________  __  _____"
  Print #hFIle, "72"
  Print #hFIle, "65"
  Print #hFIle, "73"
  Print #hFIle, "4"
  Print #hFIle, "40"
  Print #hFIle, "101.6"
  Print #hFIle, "49"
  Print #hFIle, "63.5"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "-12.7"
  Print #hFIle, "74"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "ENDTAB"

  ' ======================================================================================
  ' LAYERS
  Print #hFIle, "  0"                       ' OBJECT TYPE
  Print #hFIle, "TABLE"
  Print #hFIle, "2"                       ' TABLE NAME
  Print #hFIle, gcd.CurrentDrawing.cModel["LAYERS"].Count
  Dim i As Integer, lay As Collection
  ' individual layers
  For Each lay In gcd.CurrentDrawing.cModel["LAYERS"]
    Print #hFIle, "  0"
    Print #hFIle, "LAYER"
    Print #hFIle, "  5"                   ' handle
    Print #hFIle, Str(i)                ' "10"
    Print #hFIle, "330"
    Print #hFIle, "2"
    Print #hFIle, "100"
    Print #hFIle, "AcDbSymbolTableRecord"
    Print #hFIle, "100"
    Print #hFIle, "AcDbLayerTableRecord"
    Print #hFIle, "2"                   ' name
    If lay["name"] = Null Then
      Print #hFIle, "0"
    Else
      Print #hFIle, lay["name"]
    End If
    Print #hFIle, "70"                  '
    ' Standard flags(bit - coded values):
    ' 1 = Layer Is Frozen; otherwise layer Is Thawed
    ' 2 = Layer Is Frozen by Default In New Viewports
    ' 4 = Layer Is Locked
    ' 16 = If set, table entry Is Externally dependent On an xref
    ' 32 = If both this bit And bit 16 are set, the externally dependent xref has been successfully resolved
    ' 64 = If set, the table entry was referenced by at least one entity In the drawing the Last Time the drawing was edited.(This flag Is For the benefit Of AutoCAD commands.It can be ignored by most programs that Read DXF files And need Not be set by programs that Write DXF files)
    Print #hFIle, "  0"
    Print #hFIle, "62"                  ' color (neg = layer off)
    Print #hFIle, lay["color"]
    Print #hFIle, "6"                                               ' linetype
    Print #hFIle, lay["style"]        '"CONTINUOUS"
    Print #hFIle, "370"
    Print #hFIle, "  0"
    Print #hFIle, "390"
    Print #hFIle, "F"

  Next
  Print #hFIle, "  0"
  Print #hFIle, "ENDTAB"

  ' =====================================================================================================
  ' STYLES
  Print #hFIle, "  0"
  Print #hFIle, "TABLE"
  Print #hFIle, "2"
  Print #hFIle, "STYLE"
  Print #hFIle, "  5"
  Print #hFIle, "3"
  Print #hFIle, "330"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTable"
  Print #hFIle, "70"
  Print #hFIle, "3"
  Print #hFIle, "  0"
  Print #hFIle, "STYLE"
  Print #hFIle, "  5"
  Print #hFIle, "4A"
  Print #hFIle, "330"
  Print #hFIle, "2"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbTextStyleTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "romanc"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "41"
  Print #hFIle, "1"
  Print #hFIle, "50"
  Print #hFIle, "  0"
  Print #hFIle, "71"
  Print #hFIle, "  0"
  Print #hFIle, "42"
  Print #hFIle, "1"
  Print #hFIle, "3"
  Print #hFIle, "romanc"
  Print #hFIle, "4"
  Print #hFIle, ""
  Print #hFIle, "  0"
  Print #hFIle, "STYLE"
  Print #hFIle, "  5"
  Print #hFIle, "4B"
  Print #hFIle, "330"
  Print #hFIle, "2"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbTextStyleTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "Standard"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "40"
  Print #hFIle, "  0"
  Print #hFIle, "41"
  Print #hFIle, "1"
  Print #hFIle, "50"
  Print #hFIle, "  0"
  Print #hFIle, "71"
  Print #hFIle, "  0"
  Print #hFIle, "42"
  Print #hFIle, "1"
  Print #hFIle, "3"
  Print #hFIle, "txt"
  Print #hFIle, "4"
  Print #hFIle, ""
  Print #hFIle, "  0"
  Print #hFIle, "ENDTAB"
  Print #hFIle, "  0"
  Print #hFIle, "TABLE"
  Print #hFIle, "2"
  Print #hFIle, "VIEW"
  Print #hFIle, "  5"
  Print #hFIle, "6"
  Print #hFIle, "330"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTable"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "ENDTAB"
  Print #hFIle, "  0"
  Print #hFIle, "TABLE"
  Print #hFIle, "2"
  Print #hFIle, "UCS"
  Print #hFIle, "  5"
  Print #hFIle, "7"
  Print #hFIle, "330"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTable"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "ENDTAB"
  Print #hFIle, "  0"
  Print #hFIle, "TABLE"
  Print #hFIle, "2"
  Print #hFIle, "APPID"
  Print #hFIle, "  5"
  Print #hFIle, "9"
  Print #hFIle, "330"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTable"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "  0"
  Print #hFIle, "APPID"
  Print #hFIle, "  5"
  Print #hFIle, "12"
  Print #hFIle, "330"
  Print #hFIle, "9"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbRegAppTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "ACAD"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "APPID"
  Print #hFIle, "  5"
  Print #hFIle, "4C"
  Print #hFIle, "330"
  Print #hFIle, "9"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbRegAppTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "LibreCad"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "ENDTAB"
  Print #hFIle, "  0"
  Print #hFIle, "TABLE"
  Print #hFIle, "2"
  Print #hFIle, "DIMSTYLE"
  Print #hFIle, "  5"
  Print #hFIle, "A"
  Print #hFIle, "330"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTable"
  Print #hFIle, "70"
  Print #hFIle, "1"
  Print #hFIle, "100"
  Print #hFIle, "AcDbDimStyleTable"
  Print #hFIle, "71"
  Print #hFIle, "1"
  Print #hFIle, "  0"
  Print #hFIle, "DIMSTYLE"
  Print #hFIle, "105"
  Print #hFIle, "4D"
  Print #hFIle, "330"
  Print #hFIle, "A"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbDimStyleTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "Standard"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "40"
  Print #hFIle, "1"
  Print #hFIle, "41"
  Print #hFIle, "2.5"
  Print #hFIle, "42"
  Print #hFIle, "625"
  Print #hFIle, "43"
  Print #hFIle, "0.38"
  Print #hFIle, "44"
  Print #hFIle, "1.25"
  Print #hFIle, "45"
  Print #hFIle, "  0"
  Print #hFIle, "46"
  Print #hFIle, "  0"
  Print #hFIle, "47"
  Print #hFIle, "  0"
  Print #hFIle, "48"
  Print #hFIle, "  0"
  Print #hFIle, "49"
  Print #hFIle, "1"
  Print #hFIle, "140"
  Print #hFIle, "2.5"
  Print #hFIle, "141"
  Print #hFIle, "0.09"
  Print #hFIle, "142"
  Print #hFIle, "  0"
  Print #hFIle, "143"
  Print #hFIle, "25.4"
  Print #hFIle, "144"
  Print #hFIle, "1"
  Print #hFIle, "145"
  Print #hFIle, "  0"
  Print #hFIle, "146"
  Print #hFIle, "1"
  Print #hFIle, "147"
  Print #hFIle, "625"
  Print #hFIle, "148"
  Print #hFIle, "  0"
  Print #hFIle, "71"
  Print #hFIle, "  0"
  Print #hFIle, "72"
  Print #hFIle, "  0"
  Print #hFIle, "73"
  Print #hFIle, "  0"
  Print #hFIle, "74"
  Print #hFIle, "1"
  Print #hFIle, "75"
  Print #hFIle, "  0"
  Print #hFIle, "76"
  Print #hFIle, "  0"
  Print #hFIle, "77"
  Print #hFIle, "  0"
  Print #hFIle, "78"
  Print #hFIle, "  8"
  Print #hFIle, "79"
  Print #hFIle, "  0"
  Print #hFIle, "170"
  Print #hFIle, "  0"
  Print #hFIle, "171"
  Print #hFIle, "2"
  Print #hFIle, "172"
  Print #hFIle, "  0"
  Print #hFIle, "173"
  Print #hFIle, "  0"
  Print #hFIle, "174"
  Print #hFIle, "  0"
  Print #hFIle, "175"
  Print #hFIle, "  0"
  Print #hFIle, "176"
  Print #hFIle, "  0"
  Print #hFIle, "177"
  Print #hFIle, "  0"
  Print #hFIle, "178"
  Print #hFIle, "  0"
  Print #hFIle, "179"
  Print #hFIle, "  0"
  Print #hFIle, "271"
  Print #hFIle, "2"
  Print #hFIle, "272"
  Print #hFIle, "4"
  Print #hFIle, "273"
  Print #hFIle, "2"
  Print #hFIle, "274"
  Print #hFIle, "2"
  Print #hFIle, "275"
  Print #hFIle, "  0"
  Print #hFIle, "276"
  Print #hFIle, "  0"
  Print #hFIle, "277"
  Print #hFIle, "2"
  Print #hFIle, "278"
  Print #hFIle, "44"
  Print #hFIle, "279"
  Print #hFIle, "  0"
  Print #hFIle, "280"
  Print #hFIle, "  0"
  Print #hFIle, "281"
  Print #hFIle, "  0"
  Print #hFIle, "282"
  Print #hFIle, "  0"
  Print #hFIle, "283"
  Print #hFIle, "1"
  Print #hFIle, "284"
  Print #hFIle, "  0"
  Print #hFIle, "285"
  Print #hFIle, "  0"
  Print #hFIle, "286"
  Print #hFIle, "  0"
  Print #hFIle, "288"
  Print #hFIle, "  0"
  Print #hFIle, "289"
  Print #hFIle, "3"
  Print #hFIle, "340"
  Print #hFIle, "STANDARD"
  Print #hFIle, "341"
  Print #hFIle, ""
  Print #hFIle, "371"
  Print #hFIle, "-2"
  Print #hFIle, "372"
  Print #hFIle, "-2"
  Print #hFIle, "  0"
  Print #hFIle, "ENDTAB"

End

Private Function dxfSave3BlockRecord() As Integer

  Dim i As Integer

  Print #hFIle, "  0"
  Print #hFIle, "TABLE"
  Print #hFIle, "2"
  Print #hFIle, "BLOCK_RECORD"
  Print #hFIle, "  5"
  Print #hFIle, "1"
  Print #hFIle, "330"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTable"
  Print #hFIle, "70"
  Print #hFIle, "2"
  Print #hFIle, "  0"
  Print #hFIle, "BLOCK_RECORD"
  Print #hFIle, "  5"
  Print #hFIle, "1F"
  Print #hFIle, "330"
  Print #hFIle, "1"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbBlockTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "*Model_Space"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "280"
  Print #hFIle, "1"
  Print #hFIle, "281"
  Print #hFIle, "  0"
  Print #hFIle, "  0"
  Print #hFIle, "BLOCK_RECORD"
  Print #hFIle, "  5"
  Print #hFIle, "1E"
  Print #hFIle, "330"
  Print #hFIle, "1"
  Print #hFIle, "100"
  Print #hFIle, "AcDbSymbolTableRecord"
  Print #hFIle, "100"
  Print #hFIle, "AcDbBlockTableRecord"
  Print #hFIle, "2"
  Print #hFIle, "*Paper_Space"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, "280"
  Print #hFIle, "1"
  Print #hFIle, "281"
  Print #hFIle, "  0"
  ' block record
  For i = 0 To gcd.CurrentDrawing.arrBlocks.Max
    Print #hFIle, "  0"
    Print #hFIle, "BLOCK_RECORD"
    Print #hFIle, "  5"                   ' handle
    Print #hFIle, Str$(i)               ' "4E"
    Print #hFIle, "330"
    Print #hFIle, "1"
    Print #hFIle, "100"
    Print #hFIle, "AcDbSymbolTableRecord"
    Print #hFIle, "100"
    Print #hFIle, "AcDbBlockTableRecord"
    Print #hFIle, "2"                                   ' block name
    Print #hFIle, gcd.CurrentDrawing.arrBlocks[i].name       ' "*D1"
    Print #hFIle, "70"                                  ' insertion units
    Print #hFIle, "  0"                                   ' 0 = unitless
    Print #hFIle, "280"                                 ' explotability
    Print #hFIle, "1"                                   ' 0 = false ; 1 = true????
    Print #hFIle, "281"                                 ' scalability
    Print #hFIle, "1"

  Next

  ' fin del block record
  Print #hFIle, "  0"
  Print #hFIle, "ENDTAB"
  Print #hFIle, "  0"
  Print #hFIle, "ENDSEC"

End

Private Function dxfSave4Blocks() As Integer

  Dim i As Integer
  Dim iii As Integer

  Print #hFIle, "  0"
  Print #hFIle, "SECTION"
  Print #hFIle, "2"
  Print #hFIle, "BLOCKS"
  '===========================================================================================================
  Print #hFIle, "  0"
  Print #hFIle, "BLOCK"
  Print #hFIle, "  5"
  Print #hFIle, " 20"
  Print #hFIle, "330"
  Print #hFIle, "1F"
  Print #hFIle, "100"
  Print #hFIle, "AcDbEntity"
  Print #hFIle, "  8"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbBlockBegin"
  Print #hFIle, "2"
  Print #hFIle, "*Model_Space"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "*Model_Space"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "  0"
  Print #hFIle, "ENDBLK"
  Print #hFIle, "  5"
  Print #hFIle, "21"
  Print #hFIle, "330"
  Print #hFIle, "1F"
  Print #hFIle, "100"
  Print #hFIle, "AcDbEntity"
  Print #hFIle, "  8"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbBlockEnd"
  '===========================================================================================================
  Print #hFIle, "  0"
  Print #hFIle, "BLOCK"
  Print #hFIle, "  5"
  Print #hFIle, "1C"
  Print #hFIle, "330"
  Print #hFIle, "1B"
  Print #hFIle, "100"
  Print #hFIle, "AcDbEntity"
  Print #hFIle, "  8"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbBlockBegin"
  Print #hFIle, "2"
  Print #hFIle, "*Paper_Space"
  Print #hFIle, "70"
  Print #hFIle, "  0"
  Print #hFIle, " 10"
  Print #hFIle, "  0"
  Print #hFIle, " 20"
  Print #hFIle, "  0"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "3"
  Print #hFIle, "*Paper_Space"
  Print #hFIle, "1"
  Print #hFIle, ""
  Print #hFIle, "  0"
  Print #hFIle, "ENDBLK"
  Print #hFIle, "  5"
  Print #hFIle, "1D"
  Print #hFIle, "330"
  Print #hFIle, "1F"
  Print #hFIle, "100"
  Print #hFIle, "AcDbEntity"
  Print #hFIle, "  8"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbBlockEnd"
  ' a partir de aca van los bloques
  '===========================================================================================================
  For i = 0 To gcd.CurrentDrawing.arrBlocks.Max
    Print #hFIle, "  0"
    Print #hFIle, "BLOCK"
    Print #hFIle, "  5"                           ' handle
    Print #hFIle, Str$(i)
    Print #hFIle, "330"
    Print #hFIle, "51"
    Print #hFIle, "100"
    Print #hFIle, "AcDbEntity"
    Print #hFIle, "  8"                           ' layer
    Print #hFIle, gcd.CurrentDrawing.arrBlocks[i].layer
    Print #hFIle, "100"
    Print #hFIle, "AcDbBlockBegin"
    Print #hFIle, "  2"
    Print #hFIle, gcd.CurrentDrawing.arrBlocks[i].name
    Print #hFIle, " 70"
    ' Block - type flags(bit - coded values, may be combined):
    ' 0 = Indicates none Of the following flags apply
    ' 1 = This Is An anonymous block generated by hatching, associative dimensioning, other internal operations, Or an application
    ' 2 = This block has non - constant attribute definitions(this bit Is Not set If the block has any attribute definitions that are constant, Or has no attribute definitions at all)
    ' 4 = This block Is An external reference(xref)
    ' 8 = This block Is An xref overlay
    ' 16 = This block Is Externally dependent
    ' 32 = This Is A resolved external reference, Or dependent Of an external reference(ignored On Input )
    ' 64 = This definition Is A referenced external reference(ignored On Input )
    Print #hFIle, "1"
    Print #hFIle, " 10"                          ' Base point X
    Print #hFIle, CStr(gcd.CurrentDrawing.arrBlocks[i].x)
    Print #hFIle, " 20"
    Print #hFIle, CStr(gcd.CurrentDrawing.arrBlocks[i].y)
    Print #hFIle, " 30"
    Print #hFIle, CStr("0")
    Print #hFIle, "  3"                           ' name
    Print #hFIle, gcd.CurrentDrawing.arrBlocks[i].name
    Print #hFIle, "  1"                     ' Xref path name
    Print #hFIle, ""
    Print #hFIle, "  4"                     ' description (optional)
    Print #hFIle, ""

    ' entidades del block
    For Each eBlock As Entity In gcd.CurrentDrawing.arrBlocks[i].entities
      eExports = False
      Try eExports = eBlock.ClassHandler.DXF_Export

      If eExports Then

        eBlock.ClassHandler.ExportDXF(eBlock, hFile)
      Else
        Debug eBlock.gender, "no se exorta a DXF"
      End If
    Next
    Print #hFIle, "  0"
    Print #hFIle, "ENDBLK"
    Print #hFIle, "  5"
    Print #hFIle, gcd.CurrentDrawing.arrBlocks[i].layer
    Print #hFIle, "330"
    Print #hFIle, "51"
    Print #hFIle, "100"
    Print #hFIle, "AcDbEntity"
    Print #hFIle, "  8"
    Print #hFIle, gcd.CurrentDrawing.arrBlocks[i].layer
    Print #hFIle, "100"
    Print #hFIle, "AcDbBlockEnd"

  Next

  '===========================================================================================================
  ' fin de los bloques
  Print #hFIle, "  0"
  Print #hFIle, "ENDSEC"

End

Private Function dxfSave5Entities() As Integer

  Dim e As Entity

  Print #hFIle, "  0"
  Print #hFIle, "SECTION"
  Print #hFIle, "  2"
  Print #hFIle, "ENTITIES"

  ' here go all entities
  For Each e In gcd.CurrentDrawing.arrEntities
    eExports = False
    Try eExports = e.ClassHandler.DXF_Export

    If eExports Then
      e.ClassHandler.ExportDXF(e, hFile)
    Else
      Debug e.gender, "no se exporta a DXF"
    End If

  Next

  ' end section code
  Print #hFIle, "  0"
  Print #hFIle, "ENDSEC"

End



Private Function dxfSave6Objects() As Integer

  Print #hFIle, "  0"
  Print #hFIle, "SECTION"
  Print #hFIle, "2"
  Print #hFIle, "OBJECTS"
  Print #hFIle, "  0"
  Print #hFIle, "DICTIONARY"
  Print #hFIle, "  5"
  Print #hFIle, "C"
  Print #hFIle, "330"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbDictionary"
  Print #hFIle, "281"
  Print #hFIle, "1"
  Print #hFIle, "3"
  Print #hFIle, "ACAD_GROUP"
  Print #hFIle, "350"
  Print #hFIle, "D"
  Print #hFIle, "  0"
  Print #hFIle, "DICTIONARY"
  Print #hFIle, "  5"
  Print #hFIle, "D"
  Print #hFIle, "330"
  Print #hFIle, "C"
  Print #hFIle, "100"
  Print #hFIle, "AcDbDictionary"
  Print #hFIle, "281"
  Print #hFIle, "1"
  Print #hFIle, "  0"
  Print #hFIle, "ENDSEC"
  Print #hFIle, "  0"
  Print #hFIle, "EOF"

End








Private Function dxfSaveDimension(BlockName As String, fPuntos As Float[], Optional angle As Float = 0, layer As String = "0", colour As Integer = "256", LineType As String = "ByLayer", LineWidth As Float = "1")

  Print #hFIle, "  0"
  Print #hFIle, "DIMENSION"
  Print #hFIle, "  5"
  Print #hFIle, "79"
  Print #hFIle, "100"
  Print #hFIle, "AcDbEntity"
  Print #hFIle, "  8"
  Print #hFIle, "  0"
  Print #hFIle, "6"
  Print #hFIle, LineType
  Print #hFIle, "62"
  Print #hFIle, "256"
  Print #hFIle, "370"
  Print #hFIle, "-1"
  Print #hFIle, "100"
  Print #hFIle, "AcDbDimension"
  Print #hFIle, "2"
  Print #hFIle, "*D1"
  Print #hFIle, " 10"
  Print #hFIle, "95.15428860684773"
  Print #hFIle, " 20"
  Print #hFIle, "91.41223171692978"
  Print #hFIle, " 30"
  Print #hFIle, "  0"
  Print #hFIle, "11"
  Print #hFIle, "77.02576831856138"
  Print #hFIle, "21"
  Print #hFIle, "93.28723171692978"
  Print #hFIle, "31"
  Print #hFIle, "  0"
  Print #hFIle, "70"
  Print #hFIle, "32"
  Print #hFIle, "71"
  Print #hFIle, "  5"
  Print #hFIle, "3"
  Print #hFIle, "Standard"
  Print #hFIle, "53"
  Print #hFIle, "  0"
  Print #hFIle, "210"
  Print #hFIle, "  0"
  Print #hFIle, "220"
  Print #hFIle, "  0"
  Print #hFIle, "230"
  Print #hFIle, "1"
  Print #hFIle, "100"
  Print #hFIle, "AcDbAlignedDimension"
  Print #hFIle, " 13"
  Print #hFIle, "58.89724803027502"
  Print #hFIle, " 23"
  Print #hFIle, "89.56084474544767"
  Print #hFIle, " 33"
  Print #hFIle, "  0"
  Print #hFIle, " 14"
  Print #hFIle, "95.15428860684773"
  Print #hFIle, " 24"
  Print #hFIle, "89.37974608235277"
  Print #hFIle, " 34"
  Print #hFIle, "  0"
  Print #hFIle, "100"
  Print #hFIle, "AcDbRotatedDimension"

End


' importing

Private Sub AddCommon(e As Entity)

  e.layer = mCommon.Layer
  e.colour = mCommon.bColor
  e.LineWidth = 1 ' mCommon.LineWt  ' TODO: transformar esto
  e.linetypename = mCommon.linetype
  e.Handle = mCommon.handle


End


Private Function AddLine(obxContainer As Entity[], Points As Float[], Optional Block As String) As Boolean

  ' points are in x,y,x,y,x,y....
  Dim oEntity As New Entity

  AddCommon(oEntity)
  oEntity.ClassHandler = cadLine
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' recibimos los dos vertices de la linea x1,y1,x2,y2
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddPolyLine(obxContainer As Entity[], Points As Float[], Optional iClosed As Integer = 0, Optional Block As String) As Boolean

  ' points are in x,y,x,y,x,y....

  Dim oEntity As New Entity

  oEntity.ClassHandler = cadLWPolyline
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' recibimos los dos vertices de la linea x1,y1,x2,y2
  oEntity.fParam.Add(iClosed)                 ' cerrada o abierta
  AddCommon(oEntity)
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddDim(obxContainer As Entity[], Points As Float[], bloque As String, medida As Float, texto As String, alineacion As Integer, angulo As Float, tipo As Integer, Optional Block As String) As Boolean

  Dim oEntity As New Entity

  oEntity.ClassHandler = cadDim              ' create the new entity of proper class
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' recibimos los dos vertices de la linea x1,y1,x2,y2
  oEntity.fParam.Add(tipo)
  oEntity.fParam.Add(MEDIDA)
  oEntity.fParam.Add(alineacion)
  oEntity.fParam.Add(angulo)
  oEntity.stringdata.Add(texto)
  oEntity.stringdata.Add(bloque)
  AddCommon(oEntity)
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddSolid(obxContainer As Entity[], Points As Float[], Optional Block As String) As Boolean

  ' points are in x,y,x,y,x,y....
  ' points are in x,y,x,y,x,y....
  Dim oEntity As New Entity

  oEntity.ClassHandler = cadSolid             ' create the new entity of proper class
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' recibimos los dos vertices de la linea x1,y1,x2,y2

  AddCommon(oEntity)
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddSPLine(obxContainer As Entity[], Points As Float[], Optional iClosed As Integer = 0, Optional Block As String) As Boolean

  ' points are in x,y,x,y,x,y....
  Dim oEntity As New Entity

  oEntity.ClassHandler = cadSPLine
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' recibimos los dos vertices de la linea x1,y1,x2,y2
  oEntity.fParam.Add(iClosed)                 ' cerrada o abierta
  AddCommon(oEntity)
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddCircle(obxContainer As Entity[], Points As Float[], radious As Float, Optional Block As String) As Boolean

  ' points are in x,y,x,y,x,y....
  Dim oEntity As New Entity

  oEntity.ClassHandler = cadCircle
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' centro x1,y1
  oEntity.fParam.Add(radious)                 ' radio
  AddCommon(oEntity)
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddArc(obxContainer As Entity[], Points As Float[], r As Float, angle1 As Float, angle2 As Float, Optional Block As String) As Boolean

  ' points are in x,y,x,y,x,y....
  Dim oEntity As New Entity

  oEntity.ClassHandler = cadArc
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' centro x1,y1
  oEntity.fParam.Add(r)                      ' radio
  oEntity.fParam.Add(angle1)                   ' angulo
  oEntity.fParam.Add(angle2)                   ' angulo
  AddCommon(oEntity)
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddEllipse(obxContainer As Entity[], Points As Float[], r As Float, angle1 As Float, angle2 As Float, Optional Block As String) As Boolean

  ' points are in x,y,x,y,x,y....
  Dim oEntity As New Entity

  oEntity.ClassHandler = cadEllipse
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' centro x1,y1
  oEntity.p[2] += oEntity.p[0]                ' un pequeño truco porque gaucho usa los puntos de manera diferente a DXF
  oEntity.p[3] += oEntity.p[1]
  oEntity.fParam.Add(r)                      ' ratio minor/major
  oEntity.fParam.Add(angle1 * 180 / Pi)     ' start angle
  oEntity.fParam.Add(angle2 * 180 / Pi)      ' end angle
  AddCommon(oEntity)
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddText(obxContainer As Entity[], Points As Float[], angle As Float, height As Float, _Text As String, Optional Block As String) As Boolean

  Dim oEntity As New Entity

  oEntity.ClassHandler = cadText
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' recibimos position x1,y1
  oEntity.fParam.Add(angle)                   ' grados
  oEntity.fParam.Add(height)                  ' alto letras
  oEntity.stringdata.Add(_text)                  ' el texto
  AddCommon(oEntity)
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddMText(obxContainer As Entity[], Points As Float[], angle As Float, height As Float, _Text As String, Optional Block As String) As Boolean

  Dim oEntity As New Entity

  oEntity.ClassHandler = cadMText
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' recibimos position x1,y1 pero tal vez venga un recuadro
  oEntity.fParam.Add(angle)                  ' GRADOS
  oEntity.fParam.Add(height)                  ' alto letras
  oEntity.stringdata.add(_text)                  ' el texto
  AddCommon(oEntity)
  oEntity.Block = Block
  If oEntity.Block <> "" Then oEntity.visible = False
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)
  oEntity = Null                  ' free entity

End

Private Function AddCurve(obxContainer As Entity[], Points As Float[], Optional Block As String) As Boolean

  ' points are in x,y,x,y,x,y....
  Dim oEntity As New Entity

  oEntity.Gender = oEntity.ClassHandler.gender

End

Private Function AddInsert(obxContainer As Entity[], Points As Float[], scaleX As Float, scaleY As Float, angulo As Float, Block As String) As Boolean

  Dim oEntity As New Entity

  oEntity.ClassHandler = cadInsert
  oEntity.Gender = oEntity.ClassHandler.gender
  oEntity.P.insert(points)                    ' recibimos position x1,y1
  oEntity.fParam.Add(scaleX)
  oEntity.fParam.Add(scaleY)
  oEntity.fParam.Add(angulo)                  ' GRADOS
  AddCommon(oEntity)
  oEntity.Block = block
  obxContainer.Add(oEntity)
  oEntity.ClassHandler.finish(oEntity, -1)

  oEntity = Null                  ' free entity

End

Private Function AddBlock(Points As Float[], Block As String) As Entity[]

  Dim newBlock As New Block

  newBlock.entities = New Entity[]
  newBlock.name = block
  newBlock.x = Points[0]
  newBlock.y = Points[1]
  gcd.CurrentDrawing.arrBlocks.Add(newBlock)

  Return newBlock.entities

End

